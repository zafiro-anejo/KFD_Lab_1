# Kotlin Лаба №1. Система обмена валют

## Основные компоненты

### MoneyRepresentation
Data class для представления денежных сумм с точностью до дробной части. Сумма хранится в *Long* как количество минимальных единиц, что исключает ошибки с плавающей точкой при денежных операциях.
Переопределен метод *toString*, что позволяет автоматически форматировать сумму и валюту для вывода пользователю.

```kotlin
val money1 = MoneyRepresentation(150000L, "$")  // 1500.00$
val money2 = MoneyRepresentation(500L, "$")     // 5.0$
```

### ExchangeLogic
Data class для представления логики обмена валют с поддержкой двунаправленного сравнения. Класс описывает операцию конвертации между двумя валютами, где порядок валют не имеет значения.

#### Логика сравнения

Два объекта ExchangeLogic считаются равными в двух случаях:
##### 1. Прямое совпадение
Исходная валюта первого объекта совпадает с исходной валютой второго объекта,
и запрашиваемая валюта первого объекта совпадает с запрашиваемой валютой второго объекта.
Пример:
    
    ExchangeLogic("USD", "EUR") равен ExchangeLogic("USD", "EUR")

##### 2. Обратное совпадение
Исходная валюта первого объекта совпадает с запрашиваемой валютой второго объекта,
и запрашиваемая валюта первого объекта совпадает с исходной валютой второго объекта.
Пример:
    
    ExchangeLogic("USD", "EUR") равен ExchangeLogic("EUR", "USD")

```kotlin
val exchange1 = ExchangeLogic("USD", "EUR")
val exchange2 = ExchangeLogic("EUR", "USD")
val exchange3 = ExchangeLogic("USD", "GBP")

println(exchange1 == exchange2)  // true - обратный порядок
println(exchange1 == exchange3)  // false - разные валюты
println(exchange2 == exchange3)  // false - разные валюты
```

### UserManager
Базовый класс для управления пользователями и их балансами в системе. Класс предоставляет функционал для регистрации пользователей, управления их денежными балансами в разных валютах и проверки существования пользователей в системе. Является *open* классом, что позволяет использовать его при наследовании другими классами.

#### Основные возможности

    Регистрация новых пользователей

    Проверка существования пользователей

    Получение и отображение балансов

    Обновление балансов пользователей

    Валидация операций с пользователями

При регистрации каждый пользователь получает начальный баланс:

    RUB: 10,000,000,000 

    USD: 10,000,000,000 

    EUR: 10,000,000,000

В классе присутствуют вспомогательные методы для валидации существования/отсутствия пользователя, которые выбрасывают IllegalArgumentException при нарушении условий.Они оснащены модификаторами доступа *protected*, что позволяет использовать их в классах наследниках.

### ATM
Класс банкомата для операций с валютами, наследуемый от UserManager. Обеспечивает функционал обмена валют и динамического обновления курсов. ATM предоставляет интерфейс для конвертации валют между счетами пользователей с автоматическим изменением курсов после каждой операции. После каждой операции обмена курс автоматически изменяется от -5% до +6% от текущего значения.

#### Основные возможности

    Обмен валют между счетами пользователя

    Динамическое обновление курсов после каждой операции

    Просмотр текущих курсов в удобном формате

    Проверка достаточности средств перед операцией

#### При создании ATM устанавливаются начальные курсы, актуальные на 20.10.2025

#### Обработка ошибок
Метод выбрасывает исключения в случаях:

    Пользователь не существует (наследуется от UserManager)

    Недостаточно средств на счете

    Запрашиваемый курс обмена не поддерживается

## Результат работы
В файле Main оставлен пример работы кода, в котором доступно можно провести огромное количество операций по конвертации валют, покрутив показатель *moneyQuantity*. Конвертация будет происходить пока не выскочит ошибка о недостаточности средств.

#### Пример работы для 100 операций конвертации:
```
Изначальный баланс:
RUB: 100000000,00RUB
USD: 100000000,00USD
EUR: 100000000,00EUR
Изначальный курс валют:
RUB -> USD: 1 USD = 80,82 RUB
RUB -> EUR: 1 EUR = 93,71 RUB
USD -> EUR: 1 EUR = 1,16 USD
Ошибка после 100 операций: [ОШИБКА]Недостаточно средств для того, чтобы произвести обмен!
Финальный баланс:
RUB: 0,00RUB
USD: 100933099,29USD
EUR: 100000000,00EUR
Финальный Курс валют:
RUB -> USD: 1 USD = 97,10 RUB
RUB -> EUR: 1 EUR = 93,71 RUB
USD -> EUR: 1 EUR = 1,16 USD
```

#### Пример работы для 1000000 операций конвертации:
```
Изначальный баланс:
RUB: 100000000,00RUB
USD: 100000000,00USD
EUR: 100000000,00EUR
Изначальный курс валют:
RUB -> USD: 1 USD = 80,82 RUB
RUB -> EUR: 1 EUR = 93,71 RUB
USD -> EUR: 1 EUR = 1,16 USD
Ошибка после 1000000 операций: [ОШИБКА]Недостаточно средств для того, чтобы произвести обмен!
Финальный баланс:
RUB: 0,00RUB
USD: 613595797,83USD
EUR: 100000000,00EUR
Финальный Курс валют:
RUB -> USD: 1 USD = 0,19 RUB
RUB -> EUR: 1 EUR = 93,71 RUB
USD -> EUR: 1 EUR = 1,16 USD
```
